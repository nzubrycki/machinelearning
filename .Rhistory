getwd()
setwd("C:/Users/nzubrycki/OneDrive/Documents/CS 513/R/project/machinelearning")
# First step is to clear the environment
rm(list=ls())
# Next we load our data
# Note that our working directory has been set to our lproject folder where this file, and the data are located
data <- read.csv(file = "recipeData.csv", na.strings=c("N/A"))
# Note that our KNN algorithm will not work with non-numeric values, so we can remove columns that we do not need
# We are using the same exact data set with our neural net as well
data$SugarScale <- NULL
data$BrewMethod <- NULL
data$PrimingMethod <- NULL
data$PrimingAmount <- NULL
# Its a LOT of data so we are simply going to remove any row with NA's
data <- na.omit(data)
# Now we can separate the data into testing and training data
# We still have a lot of data, so we will be using a 50/50 split (taking every other observation)
every_other <- seq(1, nrow(data), by=2)
test_data <- data[every_other,5:18]
train_data <- data[-every_other,5:18]
#library("caret")
library("neuralnet")
all_vars <- colnames(data[5:18])
pred_vars <- all_vars[!all_vars%in%"StyleID"]
pred_vars <- paste(pred_vars, collapse = "+")
form= as.formula(paste("StyleID~", pred_vars, collapse = "+"))
#normalizing the test and train data
scaled.test.data <- scale(test_data)
scaled.train.data <- scale(train_data)
net_bc21  <- neuralnet(formula = form, data=scaled.train.data, hidden=c(4,2), threshold=0.01)
plot(net_bc21)
net_bc21
?neuralnet()
net_bc21$call
net_bc21$err.fct()
net_bc21$linear.output
net_bc21$net.result
net_bc21$result.matrix
net_bc21  <- neuralnet(formula = form, data=scaled.train.data, hidden=c(4,2), threshold=0.01, err.fct = "sse")
plot(net_bc21)
net_bc21$err.fct()
net_bc21$net.result
form
net_bc21  <- neuralnet(formula = form, data=scaled.train.data, hidden=c(4,2), threshold=0.01, err.fct = 'sse')
net_bc21  <- neuralnet(formula = form, data=scaled.train.data, hidden=c(4,2), threshold=0.01, err.fct = 'sse')
net_bc21  <- neuralnet(formula = form, data=scaled.train.data, hidden=c(4,2), threshold=0.01, err.fct = 'sse')
View(scaled.train.data)
